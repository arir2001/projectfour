<!-- blog/templates/blog/post_form.html -->
{% extends 'base.html' %}
{% url 'comments_admin' as comments_admin %}
{% load static %}
{% block content %}

<div class="container-fluid">
    <div class="row mt-2">
        <div class="col-md-6 ">
            <div class="border border-dark p-2 m-2">
                <h1> welcome back {{ user.username }}</h1>
            </div>
        </div>
        <div class="col-md-6 ">
          <h2> New comments to review: </h2>
            <div id='newcommentstoreview' class=" p-2 m-2 commentdiv">   
                <div>  
                    {% if comments %}
                    {% with comments|slice:":5" as limited_comments %}
                    {% for comment in limited_comments %}
                      <div class=" comments d-flex justify-content-around">
                        <div class="col-md-6 p-2">
                          <p class="font-weight-bold">
                            {{ comment.author }} on <span class="font-weight-normal"> {{ comment.created_on }}</span> 
                            wrote:
                          </p>
                          <div id="comment{{ comment.id }}">
                            {{ comment.body | safe }}
                          </div>
                        </div>
                        <div class="col-md-6 p-2">
                          <p class="approval">
                            This comment is awaiting approval. Approve it?
                          </p>
                          <!-- Display Delete, Archive?, Approve Button -->
                          <button class="btn btn-delete" comment_id="{{ comment.id }}">Delete</button>
                          <button class="btn btn-approve" comment_id="{{ comment.id }}" >Approve</button>
                          
                        </div>
                      </div>
                    {% endfor %}
                    {% endwith %}
                  {% else %}
                    <p class="approval">There are no comments yet.</p>
                  {% endif %}
            </div>
            
        </div>
        {% if comments|length > 5 %}
                  <div class="row"> 
                    <div class="col-md-6">
                      <p> there are more comments to be approved. </p>
                    </div>
                    <div class="col-md-6">
                      <a href="{% url 'comments_admin' %}" class="btn btn-danger">View and Manage all comments</a>
                    </div>
                  </div>
                  {% endif %}
    </div>
    <div class="row mt-2">

    </div>
    <div class="row mt-2">

    </div>
</div>

<!-- Delete confirmation modal -->
<div class="modal fade" id="deleteModal" tabindex="-1"
  aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title"
          id="deleteModalLabel">Delete comment?</h5>
        <button type="button" class="btn-close"
          data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Are you sure you want to delete this comment?
        This action cannot be undone.
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary"
          data-bs-dismiss="modal">Close</button>
        <a id="deleteConfirm" href="#" class="btn
          btn-danger">Delete</a>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="approveModal" tabindex="-1"
  aria-labelledby="approveModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title"
          id="approveModalLabel">Approve comment?</h5>
        <button type="button" class="btn-close"
          data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Are you sure you want to approve this comment?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary"
          data-bs-dismiss="modal">Close</button>
        <a id="approveConfirm" href="#" class="btn
          btn-danger">Approve</a>
      </div>
    </div>
  </div>
</div>

{% endblock content %}
{% block extras %}
<script src="{% static 'js/comments.js' %}"></script>
{% endblock %}
